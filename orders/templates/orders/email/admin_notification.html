<!-- orders/templates/orders/email/admin_notification.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</title>
</head>
<body style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 20px; color: #333;">

    <div style="max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.05);">

        <!-- === –®–ê–ü–ö–ê === -->
        {% if order.is_one_click %}
            <div style="background-color: #dc3545; padding: 20px; text-align: center; color: #ffffff;">
                <h1 style="margin: 0; font-size: 26px; text-transform: uppercase; font-weight: 800;">‚ö° –ë—ã—Å—Ç—Ä—ã–π –∑–∞–∫–∞–∑!</h1>
                <p style="margin: 5px 0 0; font-size: 16px; font-weight: bold; opacity: 0.9;">–ù—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –ø–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç—å</p>
            </div>
        {% elif order.delivery_time == 'asap' %}
            <div style="background-color: #ff9800; padding: 20px; text-align: center; color: #ffffff;">
                <h1 style="margin: 0; font-size: 24px;">üöÄ –ó–∞–∫–∞–∑ #{{ order.id }} (ASAP)</h1>
                <p style="margin: 5px 0 0; opacity: 0.9;">–ö–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ!</p>
            </div>
        {% else %}
            <div style="background-color: #333; padding: 20px; text-align: center; color: #ffffff;">
                <h1 style="margin: 0; font-size: 24px;">–ù–æ–≤—ã–π –∑–∞–∫–∞–∑ #{{ order.id }}</h1>
            </div>
        {% endif %}

        <div style="padding: 30px;">

            <!-- –î–ê–¢–ê –ò –°–£–ú–ú–ê -->
            <div style="text-align: center; margin-bottom: 30px;">
                <p style="font-size: 14px; color: #999; margin-bottom: 5px;">–°–æ–∑–¥–∞–Ω:</p>
                <strong style="font-size: 16px;">{{ order.created|date:"d.m.Y –≤ H:i" }}</strong>

                <div style="margin-top: 10px;">
                    <span style="font-size: 28px; color: #28a745; font-weight: bold;">{{ order.get_total_cost }} ‚ÇΩ</span>
                </div>
            </div>

            <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">

            <!-- –ö–û–ù–¢–ê–ö–¢–´ -->
            <table style="width: 100%; border-collapse: collapse;">
                <tr>
                    <td style="vertical-align: top; width: 50%; padding-right: 10px;">
                        <h3 style="margin: 0 0 10px; font-size: 14px; text-transform: uppercase; color: #999;">üë§ –ó–∞–∫–∞–∑—á–∏–∫</h3>
                        <p style="margin: 0 0 5px; font-size: 18px; font-weight: bold;">{{ order.first_name }} {{ order.last_name }}</p>
                        <p style="margin: 0 0 5px;">
                            <a href="tel:{{ order.phone }}" style="color: #007bff; text-decoration: none; font-weight: bold; font-size: 18px;">{{ order.phone }}</a>
                        </p>
                        {% if order.email and 'no-email' not in order.email %}
                            <p style="margin: 0; font-size: 14px; color: #666;">{{ order.email }}</p>
                        {% endif %}
                    </td>

                    <td style="vertical-align: top; width: 50%; padding-left: 10px;">
                        {% if order.recipient_name %}
                            <div style="background: #fff8e1; padding: 15px; border-radius: 8px; border: 1px solid #ffe082;">
                                <h3 style="margin: 0 0 8px; font-size: 12px; text-transform: uppercase; color: #856404; font-weight: bold;">üéÅ –ü–æ–ª—É—á–∞—Ç–µ–ª—å</h3>
                                <p style="margin: 0 0 5px; font-size: 16px;"><strong>{{ order.recipient_name }}</strong></p>
                                <p style="margin: 0; font-size: 16px;">{{ order.recipient_phone }}</p>
                            </div>
                        {% endif %}
                    </td>
                </tr>
            </table>

            <!-- –î–û–°–¢–ê–í–ö–ê -->
            <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">
            <h3 style="margin: 0 0 15px; font-size: 16px; display: flex; align-items: center;">
                {% if order.delivery_option == 'delivery' %}üöö –î–æ—Å—Ç–∞–≤–∫–∞{% else %}üè™ –°–∞–º–æ–≤—ã–≤–æ–∑{% endif %}
            </h3>

            <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; border-left: 4px solid {% if order.delivery_time == 'asap' %}#ff9800{% else %}#28a745{% endif %};">
                <p style="margin: 0 0 10px; font-size: 16px;">
                    <strong>–í—Ä–µ–º—è:</strong>
                    {% if order.delivery_time == 'asap' %}
                        <span style="color: #ff9800; font-weight: bold; text-transform: uppercase;">üöÄ –ö–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ</span>
                    {% else %}
                        {{ order.delivery_date|date:"d.m.Y" }} / <span style="font-weight: bold; background: #fff; padding: 2px 6px; border-radius: 4px; border: 1px solid #ddd;">{{ order.delivery_time }}</span>
                    {% endif %}
                </p>

                {% if order.delivery_option == 'delivery' %}
                    <p style="margin: 0;"><strong>–ê–¥—Ä–µ—Å:</strong> <br>{{ order.city }}, {{ order.address }}</p>
                {% else %}
                    <p style="margin: 0;"><strong>–ó–∞–±–µ—Ä—É—Ç –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞</strong></p>
                {% endif %}
            </div>

            <!-- === –ë–õ–û–ö –û–¢–ö–†–´–¢–ö–ò === -->
            {% if order.postcard or order.custom_postcard_image %}
                <div style="margin-top: 25px; padding: 15px; border: 2px dashed #007bff; border-radius: 8px; background-color: #f0f8ff;">
                    <h3 style="margin: 0 0 15px; font-size: 16px; color: #0056b3;">üíå –í–Ω–∏–º–∞–Ω–∏–µ: –û—Ç–∫—Ä—ã—Ç–∫–∞!</h3>

                    <div style="display: flex; gap: 15px; align-items: flex-start;">
                        <!-- –ö–ê–†–¢–ò–ù–ö–ê -->
                        <div style="flex-shrink: 0;">
                            {% if order.custom_postcard_image %}
                                <a href="{{ base_url }}{{ order.custom_postcard_image.url }}" target="_blank">
                                    <img src="{{ base_url }}{{ order.custom_postcard_image.url }}" style="width: 100px; height: 100px; object-fit: cover; border-radius: 6px; border: 1px solid #ccc; background-color: #fff;">
                                </a>
                            {% elif order.postcard.image %}
                                <a href="{{ base_url }}{{ order.postcard.image.url }}" target="_blank">
                                    <img src="{{ base_url }}{{ order.postcard.image.url }}" style="width: 100px; height: 100px; object-fit: cover; border-radius: 6px; border: 1px solid #ccc; background-color: #fff;">
                                </a>
                            {% endif %}
                        </div>

                        <!-- –¢–ï–ö–°–¢ –ò –°–°–´–õ–ö–ò -->
                        <div style="flex-grow: 1;">
                            <p style="margin: 0 0 5px; font-weight: bold;">
                                {% if order.custom_postcard_image %}–°–≤–æ—ë —Ñ–æ—Ç–æ{% else %}{{ order.postcard.title }}{% endif %}
                            </p>

                            <!-- –°—Å—ã–ª–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è -->
                            <p style="margin: 0 0 10px;">
                                <a href="{{ base_url }}{% if order.custom_postcard_image %}{{ order.custom_postcard_image.url }}{% else %}{{ order.postcard.image.url }}{% endif %}" target="_blank" style="font-size: 13px; color: #007bff; text-decoration: underline;">
                                    [–°–∫–∞—á–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª]
                                </a>
                            </p>

                            <div style="background: #fff; padding: 12px; font-style: italic; border: 1px solid #b8daff; border-radius: 4px; font-size: 15px; color: #333;">
                                {% if order.postcard_text %}
                                    "{{ order.postcard_text|linebreaksbr }}"
                                {% else %}
                                    <span style="color: #999;">(–ë–µ–∑ —Ç–µ–∫—Å—Ç–∞)</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}

            <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">

            <!-- –¢–û–í–ê–†–´ -->
            <h3 style="margin: 0 0 15px; font-size: 16px;">üõí –ö–æ—Ä–∑–∏–Ω–∞</h3>
            <table style="width: 100%; border-collapse: collapse;">
                {% for item in order.items.all %}
                    <tr style="border-bottom: 1px solid #f0f0f0;">
                        <td style="padding: 10px 0;">
                            <span style="font-size: 15px;">{{ item.product.name }}</span>

                            <!-- –Ø–†–ö–ò–ô –ë–ï–ô–î–ñ –ö–û–õ–ò–ß–ï–°–¢–í–ê –î–õ–Ø –ê–î–ú–ò–ù–ê -->
                            {% if item.quantity > 1 %}
                                <span style="display: inline-block; background-color: #ffebee; color: #c62828; padding: 2px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; margin-left: 5px; border: 1px solid #ffcdd2; vertical-align: middle;">
                                    x {{ item.quantity }}
                                </span>
                            {% endif %}

                            <div style="font-size: 12px; color: #999; margin-top: 2px;">–ê—Ä—Ç: {{ item.product.sku|default:"-" }}</div>
                        </td>
                        <td style="text-align: right; padding: 10px 0; font-weight: 600;">
                            {{ item.get_cost }} ‚ÇΩ
                        </td>
                    </tr>
                {% endfor %}

                <!-- –°–ö–ò–î–ö–ê -->
                {% if order.discount > 0 %}
                <tr>
                    <td style="padding: 10px 0; color: #28a745;">–°–∫–∏–¥–∫–∞ ({{ order.promo_code.code }})</td>
                    <td style="text-align: right; padding: 10px 0; color: #28a745;">-{{ order.get_discount_amount|floatformat:0 }} ‚ÇΩ</td>
                </tr>
                {% endif %}

                <!-- –î–û–°–¢–ê–í–ö–ê -->
                {% if order.delivery_cost > 0 %}
                <tr>
                    <td style="padding: 10px 0; color: #777;">–î–æ—Å—Ç–∞–≤–∫–∞</td>
                    <td style="text-align: right; padding: 10px 0; color: #777;">{{ order.delivery_cost }} ‚ÇΩ</td>
                </tr>
                {% endif %}
            </table>

            <!-- –ö–ù–û–ü–ö–ê -->
            <div style="text-align: center; margin-top: 40px;">
                <a href="{{ admin_order_url }}" style="background-color: #28a745; color: #ffffff; text-decoration: none; padding: 16px 35px; border-radius: 50px; font-weight: bold; font-size: 18px; display: inline-block; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);">
                    –û—Ç–∫—Ä—ã—Ç—å –≤ –ê–¥–º–∏–Ω–∫–µ
                </a>
            </div>

        </div>
    </div>
</body>
</html>