<!-- users/templates/users/password_reset_confirm.html -->
{% extends "base.html" %}

{% block title %}–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å{% endblock %}

{% block content %}
<div class="auth-page-wrapper">
    <div class="auth-card fade-in">
        <div class="icon-header">
            üîë
        </div>
        <h1>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</h1>

        {% if validlink %}
            <p class="auth-subtitle">–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–æ–≤—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.</p>

            <form method="post" class="modern-form">
                {% csrf_token %}

                {% if form.non_field_errors %}
                    <div class="error-alert">{{ form.non_field_errors }}</div>
                {% endif %}

                <!-- –ü–∞—Ä–æ–ª—å 1 -->
                <div class="input-group-modern">
                    <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <div class="input-wrapper">
                        <span class="input-icon">üîí</span>
                        {{ form.new_password1 }}
                    </div>
                    {% if form.new_password1.help_text %}
                        <small class="help-text">{{ form.new_password1.help_text|safe }}</small>
                    {% endif %}
                    {% if form.new_password1.errors %}
                        <div class="field-error">{{ form.new_password1.errors }}</div>
                    {% endif %}
                </div>

                <!-- –ü–∞—Ä–æ–ª—å 2 -->
                <div class="input-group-modern">
                    <label>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                    <div class="input-wrapper">
                        <span class="input-icon">üõ°Ô∏è</span>
                        {{ form.new_password2 }}
                    </div>
                    {% if form.new_password2.errors %}
                        <div class="field-error">{{ form.new_password2.errors }}</div>
                    {% endif %}
                </div>

                <button type="submit" class="btn btn-primary auth-btn">
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                </button>
            </form>

        {% else %}
            <div class="error-state">
                <h3 style="color: #dc3545;">–°—Å—ã–ª–∫–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞</h3>
                <p>–í–æ–∑–º–æ–∂–Ω–æ, –æ–Ω–∞ —É—Å—Ç–∞—Ä–µ–ª–∞ –∏–ª–∏ —É–∂–µ –±—ã–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞.</p>
                <a href="{% url 'password_reset' %}" class="btn btn-primary auth-btn">–ó–∞–ø—Ä–æ—Å–∏—Ç—å —Å–Ω–æ–≤–∞</a>
            </div>
        {% endif %}
    </div>
</div>

<style>
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .fade-in { animation: fadeInUp 0.5s ease-out forwards; }

    .auth-page-wrapper {
        display: flex; justify-content: center; align-items: center;
        min-height: 70vh; padding: 40px 20px;
        background-color: #f9f9f9;
        font-family: var(--default-font-family, sans-serif);
    }
    .auth-card {
        width: 100%; max-width: 450px;
        background: #fff; padding: 40px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        text-align: center;
    }
    .icon-header { font-size: 3rem; margin-bottom: 15px; }
    h1 { font-size: 1.8rem; margin: 0 0 10px 0; color: #333; font-weight: 700; }
    .auth-subtitle { color: #666; margin-bottom: 30px; }

    .modern-form { text-align: left; }
    .input-group-modern { margin-bottom: 20px; }
    .input-group-modern label { display: block; font-weight: 600; font-size: 0.9rem; margin-bottom: 8px; color: #555; }

    .input-wrapper { position: relative; }
    .input-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); opacity: 0.5; font-size: 1.2rem; }

    /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è input */
    .modern-form input {
        width: 100%; padding: 12px 15px 12px 45px;
        border: 1px solid #ddd; border-radius: 10px;
        font-size: 1rem; transition: 0.2s; box-sizing: border-box; background: #fcfcfc;
    }
    .modern-form input:focus {
        border-color: var(--accent-color, #e53935);
        background: #fff; outline: none;
        box-shadow: 0 0 0 3px rgba(229, 57, 53, 0.1);
    }

    .help-text { font-size: 0.75rem; color: #999; margin-top: 5px; display: block; line-height: 1.3; }
    .field-error { color: #dc3545; font-size: 0.85rem; margin-top: 5px; }
    .error-alert { background: #ffebee; color: #c62828; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9rem; }

    .auth-btn { width: 100%; padding: 14px; font-size: 1.1rem; border-radius: 10px; margin-top: 10px; }
</style>
{% endblock %}