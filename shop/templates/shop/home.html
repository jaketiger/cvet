<!-- shop/templates/shop/home.html -->

{% extends "base.html" %}
{% load static %}

{% block title %}MegaCvet - Главная{% endblock %}

{% block content %}
    <!-- --- БАННЕР --- -->
    {% if settings.banner_image %}
    <div class="banner">
        <img src="{{ settings.banner_image.url }}" alt="Banner">
        <div class="banner-text">
            <h1>{{ settings.banner_title }}</h1>
            <p>{{ settings.banner_subtitle }}</p>
            {% if settings.banner_link %}
                <a href="{{ settings.banner_link }}" class="banner-btn" target="_blank">Узнать больше</a>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- --- ИЗБРАННЫЕ ТОВАРЫ --- -->
    <h2 style="text-align: center; margin: 40px 0;">Популярные букеты</h2>
    <div class="product-grid">
        {% for product in featured_products %}
            <div class="product-card">
                <a href="{{ product.get_absolute_url }}">
                    {% if product.image_thumbnail %}
                        <img src="{{ product.image_thumbnail.url }}" alt="{{ product.name }}">
                    {% endif %}
                </a>
                <h2><a href="{{ product.get_absolute_url }}">{{ product.name }}</a></h2>
                <p class="price">{{ product.price }} руб.</p>
                <form action="{% url 'cart:cart_add' product.id %}" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="quantity" value="1">
                    <input type="hidden" name="update" value="False">
                    <input type="submit" value="В корзину" class="add-to-cart-btn-small">
                </form>
            </div>
        {% empty %}
            <p style="text-align: center;">Избранных товаров пока нет. Отметьте их в админ-панели.</p>
        {% endfor %}
    </div>

    <style>
        .banner { position: relative; text-align: center; color: white; border-radius: 8px; overflow: hidden; }
        .banner img { width: 100%; height: 400px; object-fit: cover; filter: brightness(0.6); }
        .banner-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .banner-btn { display: inline-block; margin-top: 20px; padding: 10px 20px; background-color: white; color: black; text-decoration: none; border-radius: 5px; }

        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .product-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; text-align: center; background-color: white; }
        .product-card img { max-width: 100%; height: 200px; object-fit: cover; border-radius: 4px; }
        .product-card h2 a { text-decoration: none; color: inherit; }
        .add-to-cart-btn-small { background-color: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px; }
    </style>
{% endblock %}