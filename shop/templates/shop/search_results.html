<!-- shop/templates/shop/search_results.html -->
{% extends "base.html" %}
{% load static %}

{% block title %}
    {% if query %}–ü–æ–∏—Å–∫: "{{ query }}"{% else %}–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤{% endif %} - {{ site_settings.shop_name }}
{% endblock %}

{% block content %}
<div class="container">
    <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
    <nav style="margin-bottom: 20px; font-size: 0.9em;">
        <a href="{% url 'shop:home' %}">–ì–ª–∞–≤–Ω–∞—è</a> &gt;
        <span>–ü–æ–∏—Å–∫</span>
    </nav>

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ñ–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
    <div style="margin-bottom: 30px;">
        <h1 style="margin-bottom: 20px; color: #333;">
            {% if query %}
                üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –¥–ª—è "{{ query }}"
            {% else %}
                üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
            {% endif %}
        </h1>

        <!-- –£–º–Ω–∞—è —Ñ–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
        <form method="get" action="{% url 'shop:search_results' %}" style="margin-bottom: 20px;">
            <div style="display: flex; max-width: 600px; position: relative;">
                <input type="text"
                       name="q"
                       id="search-input"
                       style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px 0 0 8px; font-size: 16px;"
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ä–æ–∑—ã, –±—É–∫–µ—Ç –Ω–µ–≤–µ—Å—Ç—ã..."
                       value="{{ query }}"
                       autocomplete="off">
                <!-- –ò–°–ü–†–ê–í–õ–ï–ù–û: –ó–∞–º–µ–Ω–µ–Ω inline-style –Ω–∞ –∫–ª–∞—Å—Å .btn-primary -->
                <button type="submit" class="btn-primary" style="border-radius: 0 8px 8px 0;">
                    –ù–∞–π—Ç–∏
                </button>
            </div>
            <div style="font-size: 0.8em; color: #666; margin-top: 5px;">
                üí° –ü–æ–∏—Å–∫ –ø–æ–Ω–∏–º–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–ª–æ–≤: "—Ü–≤–µ—Ç–æ–∫", "—Ü–≤–µ—Ç—ã", "—Ü–≤–µ—Ç–∫–∞–º"
            </div>
        </form>

        {% if query %}
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∏—Å–∫–∞ -->
            <div style="background: #e7f3ff; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <strong>–ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: {{ products|length }}</strong>
                        {% if query %}
                            <span style="color: #666; margin-left: 10px;">
                                –ø–æ –∑–∞–ø—Ä–æ—Å—É "{{ query }}"
                            </span>
                        {% endif %}
                    </div>
                    {% if products|length > 0 %}
                    <div style="font-size: 0.9em; color: #666;">
                        üîÑ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
                    </div>
                    {% endif %}
                </div>
            </div>
        {% endif %}
    </div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
    {% if query %}
        {% if products %}
            <div class="product-grid">
                {% for product in products %}
                <div class="product-card">
                    <a href="{{ product.get_absolute_url }}">
                        <div style="height: 200px; overflow: hidden; border-radius: 8px; margin-bottom: 15px; position: relative;">
                            <img src="
                                {% if product.image %}
                                    {{ product.image.url }}
                                {% else %}
                                    {% static 'shop/img/no_image.png' %}
                                {% endif %}
                            " alt="{{ product.name }}"
                                 style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;">
                        </div>

                        <h2>
                           {% if product.highlighted_name %}
                                {{ product.highlighted_name|safe }}
                            {% else %}
                                {{ product.name }}
                            {% endif %}
                        </h2>

                        <p style="color: #666; font-size: 0.9em; margin-bottom: 15px; line-height: 1.5; min-height: 4.5em;">
                            {% if product.highlighted_description %}
                                {{ product.highlighted_description|safe }}
                            {% else %}
                                {{ product.description_right|truncatewords:20 }}
                            {% endif %}
                        </p>

                        <p class="price">{{ product.price }} ‚ÇΩ</p>
                    </a>

                    <form action="{% url 'cart:cart_add' product.id %}" method="post" style="margin-top: 15px;">
                        {% csrf_token %}
                        <input type="hidden" name="quantity" value="1">
                        <input type="hidden" name="update" value="False">
                        <!-- –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω inline-style –∏ –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ –∫–ª–∞—Å—Å -->
                        <button type="submit" class="add-to-cart-btn-small">
                            üõí –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </form>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <!-- –£–ª—É—á—à–µ–Ω–Ω—ã–π –±–ª–æ–∫ "–Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ" -->
            <div style="text-align: center; padding: 60px 20px;">
                <div style="max-width: 500px; margin: 0 auto;">
                    <div style="font-size: 4em; margin-bottom: 20px;">üîç</div>
                    <h3 style="color: #666; margin-bottom: 20px;">–ü–æ –∑–∞–ø—Ä–æ—Å—É "{{ query }}" –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: left; margin-bottom: 20px;">
                        <h4 style="margin-bottom: 15px;">üí° –°–æ–≤–µ—Ç—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞:</h4>
                        <ul style="color: #666; line-height: 1.6;">
                            <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è</li>
                            <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–µ —Å–ª–æ–≤–∞</li>
                            <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∏–Ω–æ–Ω–∏–º—ã: "—Ä–æ–∑—ã" –≤–º–µ—Å—Ç–æ "—Ü–≤–µ—Ç—ã —Ä–æ–∑"</li>
                            <li>–ò—â–∏—Ç–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –≤ <a href="{% url 'shop:product_list_all' %}">–∫–∞—Ç–∞–ª–æ–≥–µ</a></li>
                        </ul>
                    </div>

                    <a href="{% url 'shop:product_list_all' %}" class="btn-primary">
                        –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥
                    </a>
                </div>
            </div>
        {% endif %}
    {% else %}
        <!-- –ë–ª–æ–∫ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞ -->
        <div style="text-align: center; padding: 60px 20px;">
            <div style="max-width: 500px; margin: 0 auto;">
                <div style="font-size: 4em; margin-bottom: 20px;">üîç</div>
                <h3 style="color: #666; margin-bottom: 15px;">–ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É —Ç–æ–≤–∞—Ä–æ–≤</h3>
                <p style="color: #666; line-height: 1.6; margin-bottom: 30px;">
                    –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞, –æ–ø–∏—Å–∞–Ω–∏–µ –∏–ª–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –≤ –ø–æ–ª–µ –≤—ã—à–µ.
                </p>

                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                    <a href="{% url 'shop:product_list_all' %}" class="btn-secondary">
                        üìÇ –í–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥
                    </a>
                    <a href="{% url 'shop:contacts' %}" class="btn-primary">
                        üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã
                    </a>
                </div>
            </div>
        </div>
    {% endif %}
</div>

<!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –Ω–∏–∂–µ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏–∑ main.css -->

<script>
// –ü—Ä–æ—Å—Ç—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('search-input');
    const examples = [
        '—Ä–æ–∑—ã –∫—Ä–∞—Å–Ω—ã–µ',
        '–±—É–∫–µ—Ç –Ω–µ–≤–µ—Å—Ç—ã',
        '–∫–æ–º–Ω–∞—Ç–Ω—ã–µ —Ä–∞—Å—Ç–µ–Ω–∏—è',
        '–≥–æ—Ä—à–µ—á–Ω—ã–µ —Ü–≤–µ—Ç—ã',
        '–ø–æ–¥–∞—Ä–æ–∫ –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è'
    ];

    let exampleIndex = 0;

    if (searchInput && !searchInput.value) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞
        function rotateExample() {
            searchInput.placeholder = '–ù–∞–ø—Ä–∏–º–µ—Ä: ' + examples[exampleIndex];
            exampleIndex = (exampleIndex + 1) % examples.length;
        }

        rotateExample();
        setInterval(rotateExample, 3000);
    }
});
</script>
{% endblock %}